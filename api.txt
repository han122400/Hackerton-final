# Hackerton AI ë©´ì ‘ ì—°ìŠµ í”Œë«í¼ API ë¬¸ì„œ

## ê¸°ë³¸ ì •ë³´
- **Base URL**: `http://localhost:8000`
- **API Prefix**: `/api`
- **í”„ë¡œí† ì½œ**: HTTP/HTTPS, WebSocket

---

## ğŸ“‹ ëª©ì°¨
1. [í—¬ìŠ¤ì²´í¬ API](#í—¬ìŠ¤ì²´í¬-api)
2. [ë©´ì ‘ ê´€ë ¨ API](#ë©´ì ‘-ê´€ë ¨-api)
3. [í”„ë¡œí•„ ê´€ë¦¬ API](#í”„ë¡œí•„-ê´€ë¦¬-api)
4. [ì¹´ë©”ë¼ ë¶„ì„ API](#ì¹´ë©”ë¼-ë¶„ì„-api)
5. [ì›¹ í˜ì´ì§€ ë¼ìš°íŒ…](#ì›¹-í˜ì´ì§€-ë¼ìš°íŒ…)

---

### GET `/api/health`
ë©´ì ‘ ì„œë¹„ìŠ¤ ìƒíƒœì™€ ì™¸ë¶€ API ì—°ë™ ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.

**ì‘ë‹µ:**
```json
{
  "status": "healthy",
  "openrouter_key_loaded": true,
  "typecast_key_loaded": true
}
```

---

## ğŸ¤ ë©´ì ‘ ê´€ë ¨ API

### POST `/api/generate-text`
AIë¥¼ ì‚¬ìš©í•˜ì—¬ ë©´ì ‘ ì§ˆë¬¸ì´ë‚˜ ë‹µë³€ì„ ìƒì„±í•©ë‹ˆë‹¤.

**ìš”ì²­ ë³¸ë¬¸:**
```json
{
  "prompt": "ë©´ì ‘ ì§ˆë¬¸ì„ ìƒì„±í•´ì£¼ì„¸ìš”"
}
```

**ì‘ë‹µ:**
```json
{
  "answer": "ìƒì„±ëœ AI í…ìŠ¤íŠ¸ ì‘ë‹µ"
}
```

**ì—ëŸ¬ ì½”ë“œ:**
- `400`: ë¹ˆ í”„ë¡¬í”„íŠ¸ - `EMPTY_PROMPT`
- `502`: OpenRouter API ì˜¤ë¥˜ - `OPENROUTER_ERROR: {error_message}`

---

### POST `/api/tts`
í…ìŠ¤íŠ¸ë¥¼ ìŒì„±ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤ (Text-to-Speech).

**ìš”ì²­ ë³¸ë¬¸:**
```json
{
  "text": "ë³€í™˜í•  í…ìŠ¤íŠ¸"
}
```

**ì‘ë‹µ:**
- **Content-Type**: `audio/wav`
- **Headers**: 
  - `Accept-Ranges: bytes`
  - `Cache-Control: no-store`
- **Body**: WAV ì˜¤ë””ì˜¤ ë°”ì´ë„ˆë¦¬ ë°ì´í„°

**TTS ì„¤ì •:**
- **ìŒì„± ID**: `tc_67c90d6244cf859417f2fff5` (í•œêµ­ì–´)
- **ëª¨ë¸**: `ssfm-v21`
- **ì–¸ì–´**: í•œêµ­ì–´ (`ko`)
- **ê°ì •**: ë³´í†µ (`normal`)
- **ë³¼ë¥¨**: 100
- **í…œí¬**: 0.9ë°°ì†

**ì—ëŸ¬ ì½”ë“œ:**
- `400`: ë¹ˆ í…ìŠ¤íŠ¸ - `EMPTY_TEXT`
- `502`: Typecast API ì˜¤ë¥˜ - `TYPECAST_ERROR: {error_message}`

---

## ğŸ‘¤ í”„ë¡œí•„ ê´€ë¦¬ API

### POST `/api/save_profile`

**ìš”ì²­ í˜•ì‹**: `application/x-www-form-urlencoded`

**ìš”ì²­ í•„ë“œ:**
```
name: ì‚¬ìš©ì ì´ë¦„ (í•„ìˆ˜)
email: ì´ë©”ì¼ ì£¼ì†Œ (í•„ìˆ˜)
phone: ì „í™”ë²ˆí˜¸ (í•„ìˆ˜)
birth: ìƒë…„ì›”ì¼ (í•„ìˆ˜)
address: ì£¼ì†Œ (í•„ìˆ˜)
job_title: í¬ë§ ì§ë¬´ (í•„ìˆ˜)

->
name: ì‚¬ìš©ì ì´ë¦„ (í•„ìˆ˜)
email: ì´ë©”ì¼ ì£¼ì†Œ (í•„ìˆ˜)
phone: ì „í™”ë²ˆí˜¸ (í•„ìˆ˜)
education: í•™ë ¥(í•„ìˆ˜)
career: ê²½ë ¥(í•„ìˆ˜)

```

**ì‘ë‹µ (ì„±ê³µ):**
```json
{
  "status": "success",
  "message": "ì‚¬ìš©ì ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.",
}
```

**ì‘ë‹µ (ì‹¤íŒ¨):**
```json
{
  "status": "error",
  "message": "ì˜¤ë¥˜ ë©”ì‹œì§€"
}
```

**ë°ì´í„°ë² ì´ìŠ¤:**
- **í…Œì´ë¸”**: `user_in.user_info`

---

## ğŸ“¹ ì¹´ë©”ë¼ ë¶„ì„ API

### WebSocket `/api/ws`
ì‹¤ì‹œê°„ ì–¼êµ´ ë¶„ì„ì„ ìœ„í•œ WebSocket ì—°ê²°ì…ë‹ˆë‹¤.

**ì—°ê²° URL**: `ws://localhost:8000/api/ws`

**ë°ì´í„° ì „ì†¡:**
- **í˜•ì‹**: ë°”ì´ë„ˆë¦¬ (ì´ë¯¸ì§€ ë°ì´í„°)
- **ì¸ì½”ë”©**: JPEG/PNG â†’ numpy bytes

**ìˆ˜ì‹  ë°ì´í„°:**
```json
{
  "ok": true,
  "result": {
    "face_detected": true,
    "eye_aspect_ratio": 0.25,
    "mouth_aspect_ratio": 0.15,
    "gaze_direction": "center",
    "face_position": "center",
    "confidence": 0.95
  }
}
```

**ì—ëŸ¬ ì‘ë‹µ:**
```json
{
  "ok": false,
  "err": "decode_fail"
}
```

**ë¶„ì„ í•­ëª©:**
1. **ì–¼êµ´ ì¸ì‹**: MediaPipe Face Mesh ì‚¬ìš©
2. **ëˆˆ ê¹œë¹¡ì„**: Eye Aspect Ratio (EAR) ê³„ì‚°
3. **ì… ì›€ì§ì„**: Mouth Aspect Ratio (MAR) ê³„ì‚°  
4. **ì‹œì„  ë°©í–¥**: í™ì±„ ìœ„ì¹˜ ê¸°ë°˜ ì‹œì„  ì¶”ì 
5. **ì–¼êµ´ ìœ„ì¹˜**: í™”ë©´ ë‚´ ì–¼êµ´ ìœ„ì¹˜ ë¶„ì„

---

## ğŸŒ ì›¹ í˜ì´ì§€ ë¼ìš°íŒ…

### GET `/`
ë©”ì¸ í™ˆí˜ì´ì§€ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

**ì‘ë‹µ**: `templates/index.html`

### ì •ì  íŒŒì¼
- **ê²½ë¡œ**: `/static/*`
- **ë””ë ‰í† ë¦¬**: `static/`
- **í¬í•¨**: CSS, JavaScript, ì´ë¯¸ì§€ íŒŒì¼

---

## ğŸš€ ì„œë²„ ì‹¤í–‰

```bash
# ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt

# í™˜ê²½ë³€ìˆ˜ ì„¤ì •
cp .env.example .env
# .env íŒŒì¼ì„ í¸ì§‘í•˜ì—¬ ì‹¤ì œ ê°’ ì…ë ¥

# ì„œë²„ ì‹¤í–‰
uvicorn app:app --host 0.0.0.0 --port 8000 --reload
```

---

## ğŸ“ ì‚¬ìš© ì˜ˆì‹œ

### JavaScriptì—ì„œ API í˜¸ì¶œ
```javascript
// í…ìŠ¤íŠ¸ ìƒì„±
const response = await fetch('/api/generate-text', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ prompt: 'ë©´ì ‘ ì§ˆë¬¸ì„ ë§Œë“¤ì–´ì£¼ì„¸ìš”' })
});
const data = await response.json();

// WebSocket ì—°ê²° (ì¹´ë©”ë¼ ë¶„ì„)
const ws = new WebSocket('ws://localhost:8000/api/ws');
ws.onmessage = (event) => {
    const result = JSON.parse(event.data);
    console.log('ë¶„ì„ ê²°ê³¼:', result);
};
```

### í”„ë¡œí•„ ì €ì¥
```javascript
const formData = new FormData();
formData.append('name', 'í™ê¸¸ë™');
formData.append('email', 'hong@example.com');
formData.append('phone', '010-1234-5678');
formData.append('birth', '1990-01-01');
formData.append('address', 'ì„œìš¸ì‹œ ê°•ë‚¨êµ¬');
formData.append('job_title', 'ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œì');

const response = await fetch('/api/save_profile', {
    method: 'POST',
    body: formData
});
```

---

## ğŸ” ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

1. **í™˜ê²½ë³€ìˆ˜**: API í‚¤ì™€ ì‹œí¬ë¦¿ì€ í™˜ê²½ë³€ìˆ˜ë¡œ ê´€ë¦¬
3. **CORS**: ëª¨ë“  ë„ë©”ì¸ í—ˆìš© (ê°œë°œìš©, í”„ë¡œë•ì…˜ì—ì„œëŠ” ì œí•œ í•„ìš”)
4. **ë°ì´í„°ë² ì´ìŠ¤**: superbase
5. **.gitignore**: ë¯¼ê°í•œ íŒŒì¼ Git ì¶”ì  ì œì™¸

---

## ğŸ“Š ì‘ë‹µ í˜•ì‹

ëª¨ë“  APIëŠ” JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•˜ë©°, ë‹¤ìŒê³¼ ê°™ì€ ì¼ë°˜ì ì¸ êµ¬ì¡°ë¥¼ ë”°ë¦…ë‹ˆë‹¤:

**ì„±ê³µ ì‘ë‹µ:**
```json
{
  "status": "success",
  "data": { ... },
  "message": "ì„±ê³µ ë©”ì‹œì§€"
}
```

**ì—ëŸ¬ ì‘ë‹µ:**
```json
{
  "status": "error", 
  "error_code": "ERROR_TYPE",
  "message": "ì˜¤ë¥˜ ì„¤ëª…"
}
```
